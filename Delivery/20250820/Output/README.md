# Output Folder - Generated Files

This folder contains the processed output files generated by the HR automation system. The system automatically creates VR (meal voucher) benefit calculation results in CSV format.

## Generated Files

### Primary Output
- **`VR_MENSAL_05_2025_FINAL.csv`** - Main benefit calculation results
  - **Format**: CSV with semicolon (;) separators and comma (,) decimal notation
  - **Encoding**: UTF-8
  - **Records**: Contains all eligible employees with calculated VR benefits

## File Structure

### Output File Columns
The generated CSV file contains the following columns in this exact order:

1. **`Matricula`** - Employee ID
2. **`Admissão`** - Admission date (DD/MM/YYYY format)
3. **`Sindicato do Colaborador`** - Employee's union
4. **`Competência`** - Reference period (05/2025)
5. **`Dias`** - Working days for benefit calculation
6. **`VALOR DIÁRIO VR`** - Daily VR value
7. **`TOTAL`** - Total benefit amount
8. **`Custo empresa`** - Company cost (80% of total)
9. **`Desconto profissional`** - Employee discount (20% of total)
10. **`OBS GERAL`** - General observations (usually empty)

### Data Format Specifications
- **Dates**: DD/MM/YYYY format (Brazilian standard)
- **Numbers**: Comma (,) as decimal separator
- **Currency**: Calculated in Brazilian Real (BRL)
- **Separator**: Semicolon (;) between columns
- **Encoding**: UTF-8 for proper character handling

## Processing Rules Applied

### Employee Eligibility
The output includes only employees who:
- ✅ Are active in the system
- ✅ Are not interns, apprentices, or on leave
- ✅ Are not foreign employees
- ✅ Have a calculated benefit value > 0

### Calculation Logic
- **Base Days**: Working days per state/union
- **Vacation Deduction**: Vacation days subtracted from working days
- **Termination Rules**: Pro-rated or zero benefits based on termination date and notification
- **Admission Rules**: Pro-rated benefits for new employees (April admissions)
- **Cost Allocation**: 80% company cost, 20% employee cost

### Data Sources
The output is generated from:
- Employee master data (ATIVOS.xlsx)
- April admissions (ADMISSÃO ABRIL.xlsx) 
- Vacation records (FÉRIAS.xlsx)
- Termination data (DESLIGADOS.xlsx)
- Union/state working days and values
- Exclusion lists (interns, apprentices, etc.)

## File Usage

### Internal Processing
- Used for payroll integration
- Imported into HR systems
- Basis for VR card ordering
- Audit trail for benefit calculations

### External Integration
- Can be imported into accounting systems
- Compatible with Brazilian payroll software
- Ready for bank transfer processing
- Suitable for union reporting

## Automated Actions

### Email Notification
When the file is generated, the system automatically:
- ✅ Sends email notifications to configured recipients
- ✅ Attaches the generated CSV file
- ✅ Includes summary information (employee count, generation date)
- ✅ Uses professional sender name "Skynet-I2A2"

### Email Recipients (Current Configuration)
- contatosexport021@gmail.com
- ernanif@fantinatti.com
- fabiorhein@gmail.com
- cortes.alberto06@gmail.com
- luizhermesgarcia@gmail.com

## File Management

### Backup Recommendations
- Archive generated files by processing date
- Maintain versions for audit purposes
- Store copies in secure backup location
- Document any manual adjustments

### File Naming Convention
- Base name: `VR_MENSAL_05_2025_FINAL.csv`
- Format: VR_MENSAL_[MM]_[YYYY]_FINAL.csv
- Consistency maintained across all generations

## Quality Assurance

### Validation Checks
The generated file undergoes automatic validation:
- ✅ Record count verification
- ✅ Total amount calculations
- ✅ Required field completeness
- ✅ Data format consistency
- ✅ Business rule compliance

### Manual Verification
Recommended manual checks:
- Spot-check employee records
- Verify total amounts against expectations
- Confirm admission dates for new employees
- Review termination impact on benefits

## Troubleshooting

### Common Issues
- **Empty file**: Check input data availability
- **Missing admission dates**: Verify ADMISSÃO ABRIL.xlsx file
- **Incorrect calculations**: Review union/state value mappings
- **Email delivery failure**: Check SMTP configuration

### File Recovery
- Check system logs for processing details
- Re-run automation if needed
- Verify input data integrity
- Contact system administrator for persistent issues

---

**Last Updated**: August 18, 2025  
**System Version**: SkyNET I2A2 v2.0 (Refactored Architecture)  
**Processing Engine**: Clean Architecture with SOLID Principles